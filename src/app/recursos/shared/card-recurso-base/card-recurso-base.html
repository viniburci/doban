<div class="card" [class.border-success]="isRecursoAtivo()" [class.border-danger]="!isRecursoAtivo()"
    style="width: 100%;">

    <div class="card-header-styled" [class.bg-success-subtle]="isRecursoAtivo()"
        [class.bg-danger-subtle]="!isRecursoAtivo()" (click)="toggleCollapse()" [attr.aria-expanded]="!isCollapsed()"
        [attr.aria-controls]="'recursoDetalhes-' + recurso()?.id" tabindex="0" role="button">

        <div class="d-flex justify-content-between align-items-center card-header-clickable">

            <h5 class="card-title flex-grow-1 mb-0 me-3 text-truncate">
                {{ getFieldValue(config().fieldConfig.titleField) || config().fieldConfig.titleFallback }}
            </h5>

            <i class="bi ms-3" [class]="isCollapsed() ? 'bi-chevron-down' : 'bi-chevron-up'"></i>
        </div>

        <h6 class="card-subtitle mb-0 text-muted mt-1 d-flex justify-content-between">
            <span>
                {{ getFieldValue(config().fieldConfig.subtitleField) || config().fieldConfig.subtitleFallback }}
            </span>

            <span>
                {{ recurso()?.dataEntrega | dateDisplayPipe }} - {{recurso()?.dataDevolucao | dateDisplayPipe}}
            </span>
        </h6>
    </div>

    <div class="card-content-area">

        <div class="collapse" [class.show]="!isCollapsed()" id="recursoDetalhes-{{ recurso()?.id }}">

            <div class="row nowrap-details">

                <div class="col-md-6 mb-2">
                    <strong>{{ config().fieldConfig.resourceTypeLabel }} ID: </strong>
                    <a [routerLink]="['/' + config().routeBase, getFieldValue(config().fieldConfig.resourceIdField), 'detalhes']">
                        {{ getFieldValue(config().fieldConfig.resourceIdField) || 'N/D' }}
                    </a>
                </div>

                @for (field of config().fieldConfig.detailFields; track field.field) {
                    <div class="col-md-6 mb-2">
                        <strong>{{ field.label }}</strong> {{ getFieldValue(field.field) || field.fallback }}
                    </div>
                }

                <div class="col-md-6 mb-2">
                    <strong>Data de Entrega:</strong> {{ recurso()?.dataEntrega | dateDisplayPipe }}
                </div>
                <div class="col-md-6 mb-2">
                    <strong>Data de Devolução:</strong> {{ recurso()?.dataDevolucao | dateDisplayPipe }}
                </div>

            </div>
            <button (click)="onEditarRecurso()" class="btn btn-primary mt-3 ">
                Editar Devolução
            </button>
            <button appConfirmDelete (confirmedDelete)="onConfirmDelete($event)" class="btn btn-danger mt-3 offset-1">
                Deletar
            </button>
        </div>
    </div>
</div>
